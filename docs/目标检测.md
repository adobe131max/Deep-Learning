# 目标检测 - Object Detection

## 基础知识

- anchor box                        锚框
- bounding box                      边界框
- IoU (Intersection over Union)     交并比
- NMS (Non-maximum suppression)     非极大值抑制，只保留和 ground truth 重叠度最高的 bounding box

## 算法

### RCNN

算法流程：

1. 由图像使用Select Search方法生成多个候选区域
2. 使用深度神经网络对每个候选区域提取特征
3. 根据特征使用SVM分类
4. 使用回归器修正候选框位置

### Fast-RCNN

算法流程：

1. 由图像使用Select Search方法生成多个候选区域
2. 使用深度神经网络对整个图像生成特征图，并将候选区域投影到特征图上获得特征矩阵
3. 对每个特征矩阵通过ROI pooling缩放，再通过全连接得到预测结果

### Faster-RCNN

[参考详解](https://blog.csdn.net/weixin_42310154/article/details/119889682)

算法流程：

1. 图像输入网络得到特征图
2. 使用 RPN（Region Proposal Network） 生成候选框，将候选框投影到特征图上获得特征矩阵
3. 对每个特征矩阵通过ROI pooling缩放，再通过全连接得到预测结果

**结构详解：**

conv layers：特征提取：$M \times N$ → $(M/16)\times(N/16)$

GeneralizedRCNNTransform:

1. 对图像normalize
2. 缩放图像和bbox，每个图像按照长宽中小者缩放为min_size，如果长者缩放后大于max_size则将大者缩放为max_size
3. 合并为一个tensor，高宽为batch中每张图高宽的最大值并按size_divisible向上取整，空白用0填充
4. postprocess将预测结果还原到原尺度上

RPN：

1. 对conv layers输出的特征图继续卷积：$(M/16)\times(N/16)$ → $(M/16)\times(N/16)\times256$
2. 为每个像素点生成三种面积和三种长宽比例对应9个anchor box，并由特征图网络生成每个滑动窗口的前后景概率及边界框回归参数
3. 对原始anchor box使用边界框回归参数生成候选框，再采用非极大值抑制筛选候选框
4. 输出 proposals 的左上角和右下角坐标

ROI pooling：

### SSD

### Mask-RCNN

### YOLO

### DETR

## FPN - Feature Pyramid Networks

## 数据集

### PASCAL VOC

本地路径：D:\Dataset\VOCtrainval_11-May-2012

``` plain
VOCdevkit
    └── VOC2012
         ├── Annotations               所有的图像标注信息(XML文件)
         ├── ImageSets    
         │   ├── Action                人的行为动作图像信息
         │   ├── Layout                人的各个部位图像信息
         │   │
         │   ├── Main                  目标检测分类图像信息
         │   │     ├── train.txt       训练集(5717)
         │   │     ├── val.txt         验证集(5823)
         │   │     └── trainval.txt    训练集+验证集(11540)
         │   │
         │   └── Segmentation          目标分割图像信息
         │         ├── train.txt       训练集(1464)
         │         ├── val.txt         验证集(1449)
         │         └── trainval.txt    训练集+验证集(2913)
         │ 
         ├── JPEGImages                所有图像文件
         ├── SegmentationClass         语义分割png图（基于类别）
         └── SegmentationObject        实例分割png图（基于目标）
```

### MS COCO
